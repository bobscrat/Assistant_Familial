-- MySQL Script generated by MySQL Workbench
-- Fri Apr 28 10:31:03 2017
-- Model: New Model    Version: 1.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='TRADITIONAL,ALLOW_INVALID_DATES';

-- -----------------------------------------------------
-- Schema assistant_familial
-- -----------------------------------------------------
DROP SCHEMA IF EXISTS `assistant_familial` ;

-- -----------------------------------------------------
-- Schema assistant_familial
-- -----------------------------------------------------
CREATE SCHEMA IF NOT EXISTS `assistant_familial` DEFAULT CHARACTER SET utf8 ;
USE `assistant_familial` ;

-- -----------------------------------------------------
-- Table `assistant_familial`.`family`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `assistant_familial`.`family` ;

CREATE TABLE IF NOT EXISTS `assistant_familial`.`family` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `name` VARCHAR(45) NOT NULL,
  PRIMARY KEY (`id`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `assistant_familial`.`category`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `assistant_familial`.`category` ;

CREATE TABLE IF NOT EXISTS `assistant_familial`.`category` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `name` VARCHAR(45) NOT NULL,
  `color` VARCHAR(45) NOT NULL,
  `family_id` INT NOT NULL,
  PRIMARY KEY (`id`),
  CONSTRAINT `fk_category_family1`
    FOREIGN KEY (`family_id`)
    REFERENCES `assistant_familial`.`family` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;

CREATE INDEX `fk_category_family1_idx` ON `assistant_familial`.`category` (`family_id` ASC);

CREATE UNIQUE INDEX `uk_category_family` ON `assistant_familial`.`category` (`name` ASC, `family_id` ASC);


-- -----------------------------------------------------
-- Table `assistant_familial`.`project`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `assistant_familial`.`project` ;

CREATE TABLE IF NOT EXISTS `assistant_familial`.`project` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `name` VARCHAR(45) NOT NULL,
  `family_id` INT NOT NULL,
  PRIMARY KEY (`id`),
  CONSTRAINT `fk_project_family1`
    FOREIGN KEY (`family_id`)
    REFERENCES `assistant_familial`.`family` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;

CREATE INDEX `fk_project_family1_idx` ON `assistant_familial`.`project` (`family_id` ASC);

CREATE UNIQUE INDEX `uk_project_family` ON `assistant_familial`.`project` (`name` ASC, `family_id` ASC);


-- -----------------------------------------------------
-- Table `assistant_familial`.`role`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `assistant_familial`.`role` ;

CREATE TABLE IF NOT EXISTS `assistant_familial`.`role` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `name` VARCHAR(45) NOT NULL,
  PRIMARY KEY (`id`))
ENGINE = InnoDB;

CREATE UNIQUE INDEX `name_UNIQUE` ON `assistant_familial`.`role` (`name` ASC);


-- -----------------------------------------------------
-- Table `assistant_familial`.`user`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `assistant_familial`.`user` ;

CREATE TABLE IF NOT EXISTS `assistant_familial`.`user` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `first_name` VARCHAR(45) NOT NULL,
  `birthday` DATE NULL,
  `email` VARCHAR(45) NULL,
  `password` VARCHAR(45) NULL,
  `active` TINYINT(1) NULL,
  `image` VARCHAR(45) NULL,
  `family_id` INT NOT NULL,
  `role_id` INT NOT NULL,
  PRIMARY KEY (`id`),
  CONSTRAINT `fk_user_family1`
    FOREIGN KEY (`family_id`)
    REFERENCES `assistant_familial`.`family` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_user_role1`
    FOREIGN KEY (`role_id`)
    REFERENCES `assistant_familial`.`role` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;

CREATE INDEX `fk_user_family1_idx` ON `assistant_familial`.`user` (`family_id` ASC);

CREATE INDEX `fk_user_role1_idx` ON `assistant_familial`.`user` (`role_id` ASC);

CREATE UNIQUE INDEX `mail_UNIQUE` ON `assistant_familial`.`user` (`email` ASC);


-- -----------------------------------------------------
-- Table `assistant_familial`.`periodicity`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `assistant_familial`.`periodicity` ;

CREATE TABLE IF NOT EXISTS `assistant_familial`.`periodicity` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `name` VARCHAR(45) NOT NULL,
  PRIMARY KEY (`id`))
ENGINE = InnoDB;

CREATE UNIQUE INDEX `name_UNIQUE` ON `assistant_familial`.`periodicity` (`name` ASC);


-- -----------------------------------------------------
-- Table `assistant_familial`.`priority`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `assistant_familial`.`priority` ;

CREATE TABLE IF NOT EXISTS `assistant_familial`.`priority` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `name` VARCHAR(45) NOT NULL,
  PRIMARY KEY (`id`))
ENGINE = InnoDB;

CREATE UNIQUE INDEX `name_UNIQUE` ON `assistant_familial`.`priority` (`name` ASC);


-- -----------------------------------------------------
-- Table `assistant_familial`.`contact`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `assistant_familial`.`contact` ;

CREATE TABLE IF NOT EXISTS `assistant_familial`.`contact` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `name` VARCHAR(45) NOT NULL,
  `first_name` VARCHAR(45) NULL,
  `phone` VARCHAR(45) NULL,
  `email` VARCHAR(45) NULL,
  `address` VARCHAR(45) NULL,
  `profession` VARCHAR(45) NULL,
  `comment` VARCHAR(45) NULL,
  `family_id` INT NOT NULL,
  PRIMARY KEY (`id`),
  CONSTRAINT `fk_contact_family1`
    FOREIGN KEY (`family_id`)
    REFERENCES `assistant_familial`.`family` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;

CREATE INDEX `fk_contact_family1_idx` ON `assistant_familial`.`contact` (`family_id` ASC);


-- -----------------------------------------------------
-- Table `assistant_familial`.`event`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `assistant_familial`.`event` ;

CREATE TABLE IF NOT EXISTS `assistant_familial`.`event` (
  `id` INT NOT NULL AUTO_INCREMENT,
  `name` VARCHAR(45) NOT NULL,
  `predefined` TINYINT(1) NOT NULL,
  `done` TINYINT(0) NOT NULL DEFAULT 0,
  `comment` VARCHAR(250) NULL,
  `deadline` DATETIME NULL,
  `periodicity_value` INT NULL,
  `estimated_budget` FLOAT NULL,
  `realized_budget` FLOAT NULL,
  `id_parent` INT NULL,
  `has_child` TINYINT(0) NULL,
  `category_id` INT NOT NULL,
  `user_id` INT NULL,
  `project_id` INT NULL,
  `periodicity_id` INT NULL,
  `priority_id` INT NULL,
  `contact_id` INT NULL,
  PRIMARY KEY (`id`),
  CONSTRAINT `fk_event_category`
    FOREIGN KEY (`category_id`)
    REFERENCES `assistant_familial`.`category` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_event_project1`
    FOREIGN KEY (`project_id`)
    REFERENCES `assistant_familial`.`project` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_event_user1`
    FOREIGN KEY (`user_id`)
    REFERENCES `assistant_familial`.`user` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_event_periodicity1`
    FOREIGN KEY (`periodicity_id`)
    REFERENCES `assistant_familial`.`periodicity` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_event_priority1`
    FOREIGN KEY (`priority_id`)
    REFERENCES `assistant_familial`.`priority` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_event_contact1`
    FOREIGN KEY (`contact_id`)
    REFERENCES `assistant_familial`.`contact` (`id`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;

CREATE INDEX `fk_event_category_idx` ON `assistant_familial`.`event` (`category_id` ASC);

CREATE INDEX `fk_event_project1_idx` ON `assistant_familial`.`event` (`project_id` ASC);

CREATE INDEX `fk_event_user1_idx` ON `assistant_familial`.`event` (`user_id` ASC);

CREATE INDEX `fk_event_periodicity1_idx` ON `assistant_familial`.`event` (`periodicity_id` ASC);

CREATE INDEX `fk_event_priority1_idx` ON `assistant_familial`.`event` (`priority_id` ASC);

CREATE INDEX `fk_event_contact1_idx` ON `assistant_familial`.`event` (`contact_idcontact` ASC);


SET SQL_MODE=@OLD_SQL_MODE;
SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS;
SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS;

-- -----------------------------------------------------
-- Data for table `assistant_familial`.`family`
-- -----------------------------------------------------
START TRANSACTION;
USE `assistant_familial`;
INSERT INTO `assistant_familial`.`family` (`id`, `name`) VALUES (1, 'Mouse');

COMMIT;


-- -----------------------------------------------------
-- Data for table `assistant_familial`.`category`
-- -----------------------------------------------------
START TRANSACTION;
USE `assistant_familial`;
INSERT INTO `assistant_familial`.`category` (`id`, `name`, `color`, `family_id`) VALUES (1, 'Santé', 'Green', 1);
INSERT INTO `assistant_familial`.`category` (`id`, `name`, `color`, `family_id`) VALUES (2, 'Transport', 'Purple', 1);
INSERT INTO `assistant_familial`.`category` (`id`, `name`, `color`, `family_id`) VALUES (3, 'Education', 'Blue', 1);
INSERT INTO `assistant_familial`.`category` (`id`, `name`, `color`, `family_id`) VALUES (4, 'Vacances', 'Teal', 1);
INSERT INTO `assistant_familial`.`category` (`id`, `name`, `color`, `family_id`) VALUES (5, 'Jardinage', 'Brown', 1);

COMMIT;


-- -----------------------------------------------------
-- Data for table `assistant_familial`.`role`
-- -----------------------------------------------------
START TRANSACTION;
USE `assistant_familial`;
INSERT INTO `assistant_familial`.`role` (`id`, `name`) VALUES (1, 'Admin Familial');
INSERT INTO `assistant_familial`.`role` (`id`, `name`) VALUES (2, 'Bénéficiaire');

COMMIT;


-- -----------------------------------------------------
-- Data for table `assistant_familial`.`user`
-- -----------------------------------------------------
START TRANSACTION;
USE `assistant_familial`;
INSERT INTO `assistant_familial`.`user` (`id`, `first_name`, `birthday`, `email`, `password`, `active`, `image`, `family_id`, `role_id`) VALUES (1, 'Mickey', NULL, 'bob@blabla.fr', NULL, NULL, NULL, 1, 1);
INSERT INTO `assistant_familial`.`user` (`id`, `first_name`, `birthday`, `email`, `password`, `active`, `image`, `family_id`, `role_id`) VALUES (2, 'Minnie', NULL, NULL, NULL, NULL, NULL, 1, 2);
INSERT INTO `assistant_familial`.`user` (`id`, `first_name`, `birthday`, `email`, `password`, `active`, `image`, `family_id`, `role_id`) VALUES (3, 'Dingo', NULL, NULL, NULL, NULL, NULL, 1, 2);
INSERT INTO `assistant_familial`.`user` (`id`, `first_name`, `birthday`, `email`, `password`, `active`, `image`, `family_id`, `role_id`) VALUES (4, 'Pluto', NULL, NULL, NULL, NULL, NULL, 1, 2);

COMMIT;


-- -----------------------------------------------------
-- Data for table `assistant_familial`.`periodicity`
-- -----------------------------------------------------
START TRANSACTION;
USE `assistant_familial`;
INSERT INTO `assistant_familial`.`periodicity` (`id`, `name`) VALUES (1, 'Jour');
INSERT INTO `assistant_familial`.`periodicity` (`id`, `name`) VALUES (2, 'Semaine');
INSERT INTO `assistant_familial`.`periodicity` (`id`, `name`) VALUES (3, 'Mois');
INSERT INTO `assistant_familial`.`periodicity` (`id`, `name`) VALUES (4, 'Année');
INSERT INTO `assistant_familial`.`periodicity` (`id`, `name`) VALUES (5, 'Aucun');

COMMIT;


-- -----------------------------------------------------
-- Data for table `assistant_familial`.`priority`
-- -----------------------------------------------------
START TRANSACTION;
USE `assistant_familial`;
INSERT INTO `assistant_familial`.`priority` (`id`, `name`) VALUES (1, 'Important et Urgent');
INSERT INTO `assistant_familial`.`priority` (`id`, `name`) VALUES (2, 'Important');
INSERT INTO `assistant_familial`.`priority` (`id`, `name`) VALUES (3, 'Urgent');

COMMIT;


-- -----------------------------------------------------
-- Data for table `assistant_familial`.`contact`
-- -----------------------------------------------------
START TRANSACTION;
USE `assistant_familial`;
INSERT INTO `assistant_familial`.`contact` (`id`, `name`, `first_name`, `phone`, `email`, `address`, `profession`, `comment`, `family_id`) VALUES (1, 'House', NULL, '0102030405', NULL, '1 rue des malades', 'Medecin', NULL, 1);
INSERT INTO `assistant_familial`.`contact` (`id`, `name`, `first_name`, `phone`, `email`, `address`, `profession`, `comment`, `family_id`) VALUES (2, 'Merlin', NULL, '0203040506', NULL, '1 rue kermeliett', 'Enchanteur', NULL, 1);

COMMIT;


-- -----------------------------------------------------
-- Data for table `assistant_familial`.`event`
-- -----------------------------------------------------
START TRANSACTION;
USE `assistant_familial`;
INSERT INTO `assistant_familial`.`event` (`id`, `name`, `predefined`, `done`, `comment`, `deadline`, `periodicity_value`, `estimated_budget`, `realized_budget`, `id_parent`, `has_child`, `category_id`, `user_id`, `project_id`, `periodicity_id`, `priority_id`, `contact_idcontact`) VALUES (1, 'Medecin Généraliste', true, false, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 1, NULL, NULL, 1, 1, NULL);
INSERT INTO `assistant_familial`.`event` (`id`, `name`, `predefined`, `done`, `comment`, `deadline`, `periodicity_value`, `estimated_budget`, `realized_budget`, `id_parent`, `has_child`, `category_id`, `user_id`, `project_id`, `periodicity_id`, `priority_id`, `contact_idcontact`) VALUES (2, 'Ophtalmo', true, false, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 1, NULL, NULL, NULL, NULL, NULL);
INSERT INTO `assistant_familial`.`event` (`id`, `name`, `predefined`, `done`, `comment`, `deadline`, `periodicity_value`, `estimated_budget`, `realized_budget`, `id_parent`, `has_child`, `category_id`, `user_id`, `project_id`, `periodicity_id`, `priority_id`, `contact_idcontact`) VALUES (3, 'Dentiste', true, false, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 1, NULL, NULL, NULL, NULL, NULL);
INSERT INTO `assistant_familial`.`event` (`id`, `name`, `predefined`, `done`, `comment`, `deadline`, `periodicity_value`, `estimated_budget`, `realized_budget`, `id_parent`, `has_child`, `category_id`, `user_id`, `project_id`, `periodicity_id`, `priority_id`, `contact_idcontact`) VALUES (4, 'Controle technique', true, false, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 2, NULL, NULL, NULL, NULL, NULL);
INSERT INTO `assistant_familial`.`event` (`id`, `name`, `predefined`, `done`, `comment`, `deadline`, `periodicity_value`, `estimated_budget`, `realized_budget`, `id_parent`, `has_child`, `category_id`, `user_id`, `project_id`, `periodicity_id`, `priority_id`, `contact_idcontact`) VALUES (5, 'Assurance', true, false, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 2, NULL, NULL, NULL, NULL, NULL);
INSERT INTO `assistant_familial`.`event` (`id`, `name`, `predefined`, `done`, `comment`, `deadline`, `periodicity_value`, `estimated_budget`, `realized_budget`, `id_parent`, `has_child`, `category_id`, `user_id`, `project_id`, `periodicity_id`, `priority_id`, `contact_idcontact`) VALUES (6, 'Cantine', true, false, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 3, NULL, NULL, NULL, NULL, NULL);
INSERT INTO `assistant_familial`.`event` (`id`, `name`, `predefined`, `done`, `comment`, `deadline`, `periodicity_value`, `estimated_budget`, `realized_budget`, `id_parent`, `has_child`, `category_id`, `user_id`, `project_id`, `periodicity_id`, `priority_id`, `contact_idcontact`) VALUES (7, 'Scolarité', true, false, NULL, NULL, NULL, NULL, NULL, NULL, NULL, 3, NULL, NULL, NULL, NULL, NULL);

COMMIT;
